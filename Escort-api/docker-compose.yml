services:

  escort.gateway:
    build:
      context: .
      dockerfile: GatewayDockerfile
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
    ports:
      - "8000:8080"
    depends_on:
      - escort.user.api
      - escort.client.api
      - escort.driver.api
      - escort.listing.api
      - escort.booking.api
      - escort.payment.api
      - escort.safety.api
      - escort.chat.api

  escort.user.api:
    build:
      context: .
      dockerfile: UserDockerfile
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ConnectionStrings__DefaultConnection=Host=host.docker.internal;Port=5432;Database=companionDB;Username=appuser;Password=123456789
    ports:
      - "8080:8080"
  escort.client.api:
    build:
      context: .
      dockerfile: ClientDockerfile
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ConnectionStrings__DefaultConnection=Host=host.docker.internal;Port=5432;Database=companionDB;Username=appuser;Password=123456789
    ports:
      - "8081:8080"
  escort.driver.api:
    build:
      context: .
      dockerfile: DriverDockerfile
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ConnectionStrings__DefaultConnection=Host=host.docker.internal;Port=5432;Database=companionDB;Username=appuser;Password=123456789
    ports:
      - "8082:8080"
  escort.listing.api:
    build:
      context: .
      dockerfile: ListingDockerfile
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ConnectionStrings__DefaultConnection=Host=host.docker.internal;Port=5432;Database=companionDB;Username=appuser;Password=123456789
    ports:
      - "8083:8080"
  escort.booking.api:
    build:
      context: .
      dockerfile: BookingDockerfile
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ConnectionStrings__DefaultConnection=Host=host.docker.internal;Port=5432;Database=companionDB;Username=appuser;Password=123456789
      - Services__PaymentAPI=http://escort.payment.api:8080
    ports:
      - "8088:8080"
  escort.payment.api:
    build:
      context: .
      dockerfile: PaymentDockerfile
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ConnectionStrings__DefaultConnection=Host=host.docker.internal;Port=5432;Database=companionDB;Username=appuser;Password=123456789
      - Stripe__SecretKey=${STRIPE_SECRET_KEY}
      - Stripe__PublishableKey=${STRIPE_PUBLISHABLE_KEY}
    ports:
      - "8085:8080"
  escort.safety.api:
    build:
      context: .
      dockerfile: SafetyDockerfile
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ConnectionStrings__DefaultConnection=Host=host.docker.internal;Port=5432;Database=companionDB;Username=appuser;Password=123456789
      - Stripe__SecretKey=${STRIPE_SECRET_KEY}
      - Stripe__PublishableKey=${STRIPE_PUBLISHABLE_KEY}
      - Stripe__WebhookSecret=${STRIPE_WEBHOOK_SECRET}
      - UserApi__BaseUrl=http://escort.user.api:8080
    ports:
      - "8086:8080"
  escort.chat.api:
    build:
      context: .
      dockerfile: ChatDockerfile
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ConnectionStrings__DefaultConnection=Host=host.docker.internal;Port=5432;Database=companionDB;Username=appuser;Password=123456789
      - Services__BookingAPI=http://escort.booking.api:8080
    ports:
      - "8087:8080"
